uuid: c7e64e1d-3baf-45d0-9394-0aeac613b99a
langcode: en
status: true
dependencies: {  }
id: content_validation
label: 'Content Validation'
description: 'This workflow will validate the content based on EU guidelines returning the average of quality and suggesting changes if need it.'
nodes:
  -
    id: echack_flowdrop_node_session_content_context.1
    type: universalNode
    position:
      x: 1480
      'y': 500
    data:
      label: 'Content Context'
      config:
        is_default_revision: true
        nodeType: square
        instanceTitle: ''
        instanceDescription: ''
      metadata:
        id: echack_flowdrop_node_session_content_context
        name: 'Content Context'
        type: default
        supportedTypes:
          - default
          - simple
          - square
        description: 'Load a Drupal node as context for the workflow. Supports specific revision loading.'
        category: data
        icon: 'mdi:page-layout-body'
        color: '#f97316'
        plugin_version: 1.0.0
        enabled: true
        tags: {  }
        executor_plugin: 'flowdrop_node_processor:entity_context'
        inputs:
          -
            id: entity_type
            name: 'Entity Type'
            type: input
            dataType: string
            required: false
            description: 'The entity type to load (e.g., node, taxonomy_term, user)'
            defaultValue: node
          -
            id: entity_id
            name: 'Entity ID'
            type: input
            dataType: string
            required: false
            description: 'The ID of the entity to load'
            defaultValue: ''
          -
            id: bundle
            name: Bundle
            type: input
            dataType: string
            required: false
            description: 'The entity bundle/content type (optional, used for validation)'
            defaultValue: ''
          -
            id: revision_id
            name: 'Revision ID'
            type: input
            dataType: string
            required: false
            description: 'Optional revision ID to load a specific version of the entity. If empty, loads the current/default revision.'
            defaultValue: ''
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: entity
            name: Entity
            type: output
            dataType: json
            required: false
            description: 'Full serialized entity data including fields'
          -
            id: entity_type
            name: entity_type
            type: output
            dataType: string
            required: false
            description: 'The entity type ID'
          -
            id: entity_id
            name: entity_id
            type: output
            dataType: string
            required: false
            description: 'The entity ID'
          -
            id: bundle
            name: bundle
            type: output
            dataType: string
            required: false
            description: 'The entity bundle/content type'
          -
            id: revision_id
            name: revision_id
            type: output
            dataType: string
            required: false
            description: 'The revision ID (if a specific revision was loaded)'
          -
            id: is_default_revision
            name: is_default_revision
            type: output
            dataType: boolean
            required: false
            description: 'Whether this is the default/current revision'
          -
            id: loaded_from
            name: loaded_from
            type: output
            dataType: string
            required: false
            description: "How the entity was loaded: 'session_context' (pre-injected) or 'parameters' (loaded on demand)"
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config:
          is_default_revision: true
          type: default
        configSchema:
          type: object
          properties:
            is_default_revision:
              type: boolean
              title: 'Is Default Revision'
              description: 'Whether the loaded entity is the default revision (injected via session context)'
              default: true
            nodeType:
              type: string
              title: 'Visual Type'
              description: 'Select the visual appearance for this node instance.'
              enum:
                - default
                - simple
                - square
              default: default
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: echack_flowdrop_node_session_content_context.1
      extensions:
        ui:
          hideUnconnectedHandles: true
    deletable: true
    measured:
      width: 80
      height: 80
    selected: false
    dragging: false
  -
    id: prompt_template.2
    type: universalNode
    position:
      x: 1770
      'y': 500
    data:
      label: 'Prompt Template'
      config:
        template: |-
          Please review and validate the following article:

          **Title:** {{ title }}

          **Full Article Content:**
          {% if body %}
          {{ body[0].value|raw }}
          {% else %}
          [No body content available]
          {% endif %}

          **Meta Description:**
          {% if field_meta_tags %}
          {{ field_meta_tags }}
          {% else %}
          [No meta tags configured]
          {% endif %}

          **Article Metadata:**
          - Entity Type: {{ entity_type }}
          - Bundle: {{ bundle }}
          - Status: {{ status ? 'Published' : 'Unpublished' }}
          - Language: {{ langcode }}
          - Author ID: {{ uid }}
          - Created: {{ created|date('Y-m-d H:i:s') }}
          - Last Modified: {{ changed|date('Y-m-d H:i:s') }}

          Please evaluate all 10 guidelines using the actual article content above.
        nodeType: simple
        instanceTitle: ''
        instanceDescription: ''
      metadata:
        id: prompt_template
        name: 'Prompt Template'
        type: simple
        supportedTypes:
          - default
          - simple
        description: 'Create prompts using templates with variable substitution'
        category: prompts
        icon: 'mdi:code-block-braces'
        color: '#f59e0b'
        plugin_version: 1.0.0
        enabled: true
        tags: {  }
        executor_plugin: 'flowdrop_node_processor:prompt_template'
        inputs:
          -
            id: variables
            name: Variables
            type: input
            dataType: json
            required: false
            description: 'Default variables for the template'
            defaultValue: {  }
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: prompt
            name: prompt
            type: output
            dataType: string
            required: false
            description: 'The generated prompt'
          -
            id: template
            name: template
            type: output
            dataType: string
            required: false
            description: 'The original template'
          -
            id: variables
            name: variables
            type: output
            dataType: json
            required: false
            description: 'The variables used'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config:
          template: ''
          type: simple
        configSchema:
          type: object
          properties:
            template:
              type: string
              title: Template
              description: 'The prompt template with variables in {{variable}} format'
              default: ''
              format: template
            nodeType:
              type: string
              title: 'Visual Type'
              description: 'Select the visual appearance for this node instance.'
              enum:
                - default
                - simple
              default: simple
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: prompt_template.2
      extensions:
        ui:
          hideUnconnectedHandles: false
    deletable: true
    measured:
      width: 288
      height: 103
    selected: false
    dragging: false
  -
    id: flowdrop_ai_provider_chat_model.1
    type: universalNode
    position:
      x: 2250
      'y': 390
    data:
      label: 'Chat Model (Drupal AI)'
      config:
        model: mistral-medium-latest
        temperature: 0
        maxTokens: 2000
        systemPrompt: |-
          You are a JSON generator. Output ONLY valid JSON. No text, no markdown, no explanation.

          you must not use codeblock. DON't use "```json\n" at all.

          It is CRITICALLY important that the output is JSON and pure json

          You are an expert content quality validator. Evaluate articles using these 10 EU-inspired guidelines:
          1. Accuracy & Evidence
          2. Clarity & Plain Language
          3. Neutrality & Objectivity
          4. Source Transparency
          5. Legal & Policy Consistency
          6. Audience Relevance
          7. Structure & Coherence
          8. Completeness & Context
          9. Inclusivity & Language Ethics
          10. Practical Value

          Score each guideline 1-5 and calculate an overall quality score (1-100).

          Generate a content validation JSON from the input content. IMPORTANT: Extract these values from the input data: title (use the "title" field), nid (use the "id" field as an INTEGER), vid (look inside "fields" then "vid" then first array element then "value" - this is the revision ID as an INTEGER).

          Example output format: {"label":"Content Validation: Article Title Here","status":true,"description":"AI content validation","field_flowdrop_workflow":"content_validation_fixer","field_content_revision":{"target_id":123,"target_revision_id":456},"field_validation_status":"done","field_validation_result":"Your detailed analysis with scores and suggestions here"}

          CRITICAL: target_id and target_revision_id MUST be integers (not arrays, not null). If you cannot find the id, use 0.

          OUTPUT ONLY THE JSON. START YOUR RESPONSE WITH { AND END WITH }
        nodeType: default
        instanceTitle: 'Content Validator AI'
        instanceDescription: ''
      metadata:
        id: flowdrop_ai_provider_chat_model
        name: 'Chat Model (Drupal AI)'
        type: default
        supportedTypes:
          - default
        description: 'AI chat model for conversation and text generation'
        category: ai
        icon: 'mdi:robot'
        color: '#8b5cf6'
        plugin_version: 1.0.0
        enabled: true
        tags:
          - model
          - ai
        executor_plugin: 'flowdrop_ai_provider:chat_model'
        inputs:
          -
            id: message
            name: message
            type: input
            dataType: string
            required: false
            description: 'The message to send to the AI'
            defaultValue: ''
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: response
            name: response
            type: output
            dataType: string
            required: false
            description: 'The AI generated response'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config:
          model: mistral-large-latest
          temperature: 0.7
          maxTokens: 1000
          systemPrompt: ''
          type: default
        configSchema:
          type: object
          properties:
            model:
              type: string
              title: Model
              description: 'The AI model to use'
              default: mistral-large-latest
            temperature:
              type: number
              title: Temperature
              description: 'Controls randomness (0-2)'
              default: 0.7
              minimum: 0
              maximum: 2
            maxTokens:
              type: integer
              title: 'Max Tokens'
              description: 'Maximum tokens in response'
              default: 1000
            systemPrompt:
              type: string
              title: 'System Prompt'
              description: 'System prompt to set AI behavior'
              default: ''
              format: textarea
            nodeType:
              type: string
              title: 'Visual Type'
              description: 'Select the visual appearance for this node instance.'
              enum:
                - default
              default: default
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: flowdrop_ai_provider_chat_model.1
      extensions:
        ui:
          hideUnconnectedHandles: false
    deletable: true
    measured:
      width: 288
      height: 440
    selected: false
    dragging: false
  -
    id: json_to_data.1
    type: universalNode
    position:
      x: 2740
      'y': 700
    data:
      label: 'JSON to Data'
      config: {  }
      metadata:
        id: json_to_data
        name: 'JSON to Data'
        type: default
        supportedTypes:
          - default
        description: 'Convert JSON string to structured data (array/object)'
        category: data
        icon: 'mdi:code-json'
        color: '#f97316'
        plugin_version: 1.0.0
        enabled: true
        tags: {  }
        executor_plugin: 'flowdrop_node_processor:json_to_data'
        inputs:
          -
            id: json
            name: 'JSON String'
            type: input
            dataType: string
            required: false
            description: 'The JSON string to decode into structured data'
            defaultValue: ''
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: data
            name: data
            type: output
            dataType: mixed
            required: false
            description: 'The decoded structured data (array/object)'
          -
            id: success
            name: success
            type: output
            dataType: boolean
            required: false
            description: 'Whether the conversion was successful'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config: {  }
        configSchema:
          type: object
          properties:
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: json_to_data.1
    deletable: true
    measured:
      width: 288
      height: 515
    selected: false
    dragging: false
  -
    id: flowdrop_node_processor_validation_save.1
    type: universalNode
    position:
      x: 3250
      'y': 500
    data:
      label: 'Save Validation'
      config:
        entity_type: ai_content_validation_item
        instanceTitle: ''
        instanceDescription: ''
      metadata:
        id: flowdrop_node_processor_validation_save
        name: 'Save Validation'
        type: default
        supportedTypes:
          - default
        description: 'Create validation entry'
        category: processing
        icon: 'mdi:alert-circle-check-outline'
        color: '#14b8a6'
        plugin_version: 1.0.0
        enabled: true
        tags: {  }
        executor_plugin: 'flowdrop_node_processor:entity_save'
        inputs:
          -
            id: values
            name: 'Field Values'
            type: input
            dataType: json
            required: false
            description: 'The field values to set on the entity as key-value pairs'
            defaultValue: {  }
          -
            id: trigger
            name: Trigger
            type: input
            dataType: trigger
            required: false
            description: ''
        outputs:
          -
            id: entity_id
            name: entity_id
            type: output
            dataType: string
            required: false
            description: 'The ID of the saved entity'
          -
            id: entity_type
            name: entity_type
            type: output
            dataType: string
            required: false
            description: 'The entity type'
          -
            id: is_new
            name: is_new
            type: output
            dataType: boolean
            required: false
            description: 'Whether a new entity was created (true) or existing was updated (false)'
          -
            id: revision_created
            name: revision_created
            type: output
            dataType: boolean
            required: false
            description: 'Whether a new revision was created on save'
          -
            id: revision_id
            name: revision_id
            type: output
            dataType: string
            required: false
            description: 'The revision ID of the saved entity (if revisionable)'
          -
            id: entity
            name: entity
            type: output
            dataType: json
            required: false
            description: 'Full serialized entity data in the same format as Entity Trigger output'
          -
            id: trigger
            name: Trigger
            type: output
            dataType: trigger
            required: false
            description: 'Emitted when this node completes execution'
        config:
          entity_type: ai_content_validation_item
        configSchema:
          type: object
          properties:
            entity_type:
              type: string
              title: 'Entity Type'
              description: 'The entity type to create/update (e.g., node, user, taxonomy_term)'
              default: node
            instanceTitle:
              type: string
              title: Title
              description: 'Override the default node title for this instance.'
              x-display-order: -2
            instanceDescription:
              type: string
              title: Description
              description: 'Override the default description for this instance.'
              format: multiline
              x-display-order: -1
          required: {  }
      nodeId: flowdrop_node_processor_validation_save.1
      extensions:
        ui:
          hideUnconnectedHandles: false
    deletable: true
    measured:
      width: 288
      height: 815
    selected: false
    dragging: true
edges:
  -
    id: xy-edge__prompt_template.2prompt_template.2-output-prompt-flowdrop_ai_provider_chat_model.1flowdrop_ai_provider_chat_model.1-input-message
    source: prompt_template.2
    target: flowdrop_ai_provider_chat_model.1
    data:
      targetNodeType: universalNode
      targetCategory: ai
      metadata:
        edgeType: data
        sourcePortDataType: string
    sourceHandle: prompt_template.2-output-prompt
    targetHandle: flowdrop_ai_provider_chat_model.1-input-message
    style: 'stroke: var(--flowdrop-edge-data-color);'
    markerEnd:
      type: arrowclosed
      width: 16
      height: 16
      color: '#9ca3af'
    class: flowdrop--edge--data
  -
    id: xy-edge__echack_flowdrop_node_session_content_context.1echack_flowdrop_node_session_content_context.1-output-entity-prompt_template.2prompt_template.2-input-variables
    source: echack_flowdrop_node_session_content_context.1
    target: prompt_template.2
    data:
      targetNodeType: universalNode
      targetCategory: prompts
      metadata:
        edgeType: data
        sourcePortDataType: json
    sourceHandle: echack_flowdrop_node_session_content_context.1-output-entity
    targetHandle: prompt_template.2-input-variables
    style: 'stroke: var(--flowdrop-edge-data-color);'
    markerEnd:
      type: arrowclosed
      width: 16
      height: 16
      color: '#9ca3af'
    class: flowdrop--edge--data
  -
    id: xy-edge__json_to_data.1json_to_data.1-output-data-flowdrop_node_processor_validation_save.1flowdrop_node_processor_validation_save.1-input-values
    source: json_to_data.1
    target: flowdrop_node_processor_validation_save.1
    data:
      targetNodeType: universalNode
      targetCategory: processing
      metadata:
        edgeType: data
        sourcePortDataType: mixed
    sourceHandle: json_to_data.1-output-data
    targetHandle: flowdrop_node_processor_validation_save.1-input-values
    style: 'stroke: var(--flowdrop-edge-data-color);'
    markerEnd:
      type: arrowclosed
      width: 16
      height: 16
      color: '#9ca3af'
    class: flowdrop--edge--data
  -
    id: xy-edge__flowdrop_ai_provider_chat_model.1flowdrop_ai_provider_chat_model.1-output-response-json_to_data.1json_to_data.1-input-json
    source: flowdrop_ai_provider_chat_model.1
    target: json_to_data.1
    data:
      targetNodeType: universalNode
      targetCategory: data
      metadata:
        edgeType: data
        sourcePortDataType: string
    sourceHandle: flowdrop_ai_provider_chat_model.1-output-response
    targetHandle: json_to_data.1-input-json
    style: 'stroke: var(--flowdrop-edge-data-color);'
    markerEnd:
      type: arrowclosed
      width: 16
      height: 16
      color: '#9ca3af'
    class: flowdrop--edge--data
metadata:
  version: 1.0.0
  createdAt: '2026-01-28T09:01:32.652Z'
  updatedAt: '2026-01-28T13:29:37.971Z'
created: 1769590598
changed: 1770563768
uid: 0
